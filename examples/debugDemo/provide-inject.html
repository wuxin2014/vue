<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
<script src="../../dist/vue.js"></script>
<div id="app" style="border: 1px solid red; padding: 10px;">
  <h1 style="color: red;">parent-root</h1>
  <com-a :info="info"></com-a>
  <button @click="handleClick">变更</button>
</div>
<script>
  // 当前实例provides和父级实例provides相同时，通过原型链建立连接 vue3
  debugger
  new Vue({
    el: '#app',
    components: {
      comA: {
        template: `<div style="border: 1px solid blue">
          <h1>children</h1>
          <com-b></com-b>
        </div>`,
        props: {
          info: { type: Object, default: () => ({}) }
        },
        components: {
          comB: {
            inject: ['foo', 'info'],
            // inject: {
            //   bar: {
            //     from: "foo", // 如果与原注入属性名相同时，该属性是可选的
            //     default: "test" // 默认值写法
            //   },
            //   info: {
            //     from: "info",
            //   },
            // },
            template: `<div>{{ foo }}-{{info || '--'}}</div>`,
          }
        },
        // provide:{
        //   info: this.info // 取不到值
        // },
        // provide: {
        //   foo: 'bar'
        // },
        provide() {
          return {
            info: this.info
          }
        }
      }
    },
    // provide:{
    //   foo: this.name // 取不到值
    // },
    provide() {
      return {
        foo: this.name
      }
    },
    data() {
      return {
        name: 'testText',
        info: { name: 'haha', age: 16 }
      }
    },
    methods: {
      handleClick() {
        this.info.age = 100
        this.info.sex = 'male' 
      }
    }
  })
  // 提示：provide 和 inject 绑定并不是可响应的。这是刻意为之的。然而，如果你传入了一个可监听的对象，那么其对象的 property 还是可响应的。
</script>
</body>

</html>
